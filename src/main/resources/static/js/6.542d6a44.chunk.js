(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{632:function(e,t,a){},828:function(e,t,a){"use strict";a.r(t);a(549);var l=a(587),n=(a(610),a(606)),o=(a(552),a(589)),i=(a(826),a(824)),r=(a(483),a(481)),s=(a(506),a(503)),c=(a(553),a(586)),p=(a(627),a(825)),u=a(128),m=a(171),d=a(508),h=a(509),f=a(546),g=a(510),F=a(547),b=(a(554),a(608)),y=(a(555),a(580)),w=(a(556),a(607)),E=a(6),S=a.n(E),C=(a(632),a(121)),v=a(60),k=a(16),x=a(34),L=a(122),N=a.n(L),O=a(59),j=w.a.Item,R=y.a.Content,P=b.a.info,I=b.a.error,V=b.a.success,D={labelCol:{span:10},wrapperCol:{span:14}},T={md:24,lg:12,xl:8},K=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(f.a)(this,Object(g.a)(t).call(this,e))).generateForm=function(e){var t=a.props.form,l=(t.getFieldDecorator,t.setFieldsValue),n=[],o=[];e.forEach(function(e){1===e.canSearch&&(n.push(e.tableCollumName),o.push(e))}),a.setState({fields:Object(m.a)(new Set(n))}),l({keys:o})},a.loadPage=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;a.setState({pageNo:e},function(){a.props.form.validateFields(function(l,n){if(!l){var o=a.state.fields,i={};i.pageNo=e,i.pageSize=t,i.tableName=n.fileId,i.condition={},o.forEach(function(e){n[e]&&""!==n[e]&&(i.condition[e]=n[e])}),a.props.actions.getTableList(i),a.setState({selectedRowKeys:[],selectedRows:[]})}})})},a.handlePageChange=function(e,t){a.loadPage(e,t)},a.handleShowSizeChange=function(e,t){a.loadPage(1,t)},a.handleSearch=function(e){e&&e.preventDefault(),a.loadPage()},a.batchUpdate=function(){var e=a.state.selectedRows,t=a.props.form.getFieldValue;a.props.actions.batchUpdate({list:e,tableName:t("fileId")})},a.showSuccess=function(e){V({title:"Success",content:e,okText:"Confirm",okType:"info",onOk:function(){a.loadPage()}})},a.showError=function(e){I({title:"Faild",content:e,okText:"Confirm",okType:"info"})},a.showInfo=function(e){P({title:"Option Tip",content:e,okText:"Confirm",okType:"info"})},a.exportFile=function(){var e=(0,a.props.form.getFieldValue)("fileId");e&&""!==e?window.open("".concat(x.a.config.export,"?tableName=").concat(e)):a.showError("Please select the file!")},a.changeSelectGroup=function(e){e&&""!==e&&(a.props.actions.getColumnList({tableName:e}),a.loadPage())},a.getFileList=function(){a.props.actions.getFileList()},a.handleShowModal=function(e){var t=e.modalVar,l=e.flag,n=e.cb;a.setState(Object(u.a)({},t,l)),n&&n()},a.handleFieldsBlur=function(e){var t=e.key,l=e.value;(0,a.props.form.setFieldsValue)(Object(u.a)({},t,l))},a.handleBlur=function(e){var t=e.key,l=e.value,n=e.formKey,o=e.id;(0,a.props.form.setFieldsValue)(Object(u.a)({},n,l)),a.props.actions.editData({key:t,value:l,id:o})},a.resetForm=function(){a.setState({selectedRowKeys:[],selectedRows:[]}),a.props.form.resetFields(),a.props.actions.clearData()},a.handleDeleteFile=function(){var e=(0,a.props.form.getFieldValue)("fileId");b.a.confirm({title:"Operation",content:"confirm delete files?",onOk:function(){a.props.actions.tableDelete({tableName:e}),a.props.form.resetFields()},onCancel:function(){}})},a.state={isShowModal:!1,fileLoading:!1,selectedRowKeys:[],selectedRows:[],formSearch:[],fields:[]},a}return Object(F.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){this.getFileList()}},{key:"componentWillReceiveProps",value:function(e){this.props.route.path!==e.route.path&&""!==e.route.path&&this.resetForm(),this.props.refreshFileFlag!==e.refreshFileFlag&&e.refreshFileFlag&&(this.getFileList(),this.props.actions.resetState()),this.props.columnList!==e.columnList&&e.columnList.length>0&&this.generateForm(e.columnList),this.props.operateSuccessFlag!==e.operateSuccessFlag&&!0===e.operateSuccessFlag&&(this.showSuccess(e.operateInfo),this.props.actions.resetState()),this.props.operateFailFlag!==e.operateFailFlag&&!0===e.operateFailFlag&&(this.showError(e.operateInfo),this.props.actions.resetState())}},{key:"render",value:function(){var e=this,t=this,a=this.props.form,u=a.getFieldDecorator,m=a.getFieldValue,d=m("fileId"),h=this.props,f=h.columnList,g=h.tableList,F=h.fileList,b=h.loading,y=h.role,C=this.state,v=C.fileLoading,k=C.selectedRowKeys,x=this.props.pageInfo,L=x.pageNum,N=x.total,P=x.pageSize,I=f&&f.length>0?f.filter(function(e){return 1===e.canView}).map(function(t){return{title:t.excelCollumName,key:t.tableCollumName,render:function(a,l){return 1===t.canEdit?S.a.createElement(j,{label:""},u("".concat(t.tableCollumName,"_").concat(l.id),{initialValue:l[t.tableCollumName],onChange:function(a){return e.handleBlur({id:l.id,formKey:"".concat(t.tableCollumName,"_").concat(l.id),value:a.target.value,key:t.tableCollumName})}})(S.a.createElement(p.a,{placeholder:"\u8bf7\u8f93\u5165",style:{width:"100px"}}))):S.a.createElement("span",null,l[t.tableCollumName])}}}):[],V={current:L,total:N,pageSize:P,showSizeChanger:!0,showQuickJumper:!0,onChange:this.handlePageChange,onShowSizeChange:this.handleShowSizeChange},K={name:"file",beforeUpload:function(e,t){},showUploadList:!1,customRequest:function(e){var a=new FormData;a.append("excelFile",e.file),t.props.actions.uploadFile(a)}},z={selectedRowKeys:k,onChange:function(t,a){e.setState({selectedRowKeys:t,selectedRows:a})},getCheckboxProps:function(e){return{disabled:!1,name:e.name}}};u("keys",{initialValue:[]});var B=m("keys").map(function(t){return S.a.createElement(c.a,T,S.a.createElement(j,Object.assign({},D,{label:"".concat(t.excelCollumName)}),u("".concat(t.tableCollumName),{initialValue:"",onChange:function(a){return e.handleFieldsBlur({id:t.tableCollumName,value:a.target.value})}})(S.a.createElement(p.a,{placeholder:"\u8bf7\u8f93\u5165"}))))});return S.a.createElement("div",{className:"page-index"},S.a.createElement(l.a,{spinning:v},S.a.createElement(R,null,S.a.createElement(w.a,{className:"ant-advanced-search-form",onSubmit:this.handleSearch},S.a.createElement(o.a,{gutter:24},S.a.createElement(c.a,{span:14,style:{height:70}},S.a.createElement(j,{labelCol:{span:6},wrapperCol:{span:18},label:"\u6587\u4ef6(File)"},u("fileId",{rules:[{required:!0,whitespace:!0,message:"Please select the file"}]})(S.a.createElement(s.a,{showSearch:!0,optionFilterProp:"children",allowClear:!0,style:{width:400},placeholder:"\u8bf7\u9009\u62e9",onSelect:this.changeSelectGroup},F&&F.length>0&&F.map(function(e){return S.a.createElement(s.a.Option,{title:e.excelName,key:"tableFile_".concat(e.id),value:e.tableName},e.excelName)}))))),y&&"admin"===y&&S.a.createElement(E.Fragment,null,S.a.createElement(c.a,{span:10,style:{textAlign:"left"}},d&&""!==d&&S.a.createElement(r.a,{type:"default",style:{marginRight:"15px",marginLeft:"-25px"},onClick:this.handleDeleteFile},"\u5220\u9664\u6587\u4ef6(Delete File)"),S.a.createElement(i.a,K,S.a.createElement(r.a,{type:"primary"},"\u4e0a\u4f20\u6587\u4ef6(Upload File)")),S.a.createElement(r.a,{style:{marginLeft:"10px"},type:"default",onClick:this.exportFile},"\u5bfc\u51fa(Export File)")),S.a.createElement(c.a,{style:{clear:"both"}}))),S.a.createElement(o.a,{gutter:24},B),S.a.createElement(o.a,{gutter:24},S.a.createElement(c.a,Object.assign({},T,{style:{marginLeft:"100px",marginBottom:"15px"}}),S.a.createElement(r.a,{type:"primary",htmlType:"submit"},"\u67e5\u8be2(Search)"),"\xa0\xa0\xa0\xa0",S.a.createElement(r.a,{type:"default",onClick:this.resetForm},"\u91cd\u7f6e(Reset)")))),S.a.createElement("h3",{style:{margin:"0 0 5px",paddingTop:"25px",borderTop:"1px solid #ddd"}}),S.a.createElement(o.a,{gutter:24,style:{marginBottom:"10px"}},S.a.createElement(c.a,{style:{textAlign:"left"},span:12},S.a.createElement(r.a,{type:"primary",onClick:this.batchUpdate,disabled:!k.length>0},"\u6279\u91cf\u66f4\u65b0(Batch Update)"),"\xa0\xa0\xa0\xa0","admin"===y&&S.a.createElement(O.a,{to:"/edit"},"\u8df3\u8f6c\u7f16\u8f91\u8868\u5934(Jump Edit Column)")),S.a.createElement(c.a,{style:{textAlign:"right"},span:12},S.a.createElement("div",{className:"search-count"},"\u5171 ",V.total," \u6761"))),S.a.createElement(l.a,{spinning:b},S.a.createElement(n.a,{scroll:{x:"max-content"},rowKey:"id",className:"table-list",rowSelection:z,dataSource:g,columns:I,pagination:V})))))}}]),t}(E.PureComponent),z=w.a.create()(K);t.default=Object(C.connect)(function(e){var t=e.resumeReducer;return{resultList:t.resultList,operateSuccessFlag:t.operateSuccessFlag,operateFailFlag:t.operateFailFlag,operateInfo:t.operateInfo,tableList:t.tableList,fileList:t.fileList,refreshFileFlag:t.refreshFileFlag,columnList:t.columnList,pageInfo:t.pageInfo,loading:t.loading}},function(e){return{actions:Object(v.bindActionCreators)(k.a,e)}})(function(e){var t=function(t){function a(e){var t;return Object(d.a)(this,a),(t=Object(f.a)(this,Object(g.a)(a).call(this,e))).state={role:"/admin"===e.route.path?"admin":"employee"},t}return Object(F.a)(a,t),Object(h.a)(a,[{key:"componentWillReceiveProps",value:function(e){this.props.route.path!==e.route.path&&""!==e.route.path&&("/admin"===e.route.path?this.setState({role:"admin"}):this.setState({role:"employee"}))}},{key:"render",value:function(){var t=this.state.role;return S.a.createElement(e,Object.assign({role:t},this.props))}}]),a}(E.PureComponent);return N()(t,e)}(z))}}]);
//# sourceMappingURL=6.542d6a44.chunk.js.map