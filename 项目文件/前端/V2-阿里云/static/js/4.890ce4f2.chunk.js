(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{622:function(e,t,a){},823:function(e,t,a){"use strict";a.r(t);a(542);var l=a(576),n=(a(821),a(816)),o=(a(608),a(726)),r=(a(822),a(818)),i=(a(489),a(488)),s=(a(544),a(540)),c=(a(613),a(723)),p=(a(614),a(820)),u=a(128),m=a(171),h=a(545),d=a(546),f=a(595),g=a(547),b=a(596),F=(a(616),a(819)),y=(a(618),a(718)),w=(a(620),a(817)),E=a(6),v=a.n(E),S=(a(622),a(122)),C=a(60),k=a(29),x=a(53),L=a(121),N=a.n(L),O=w.a.Item,j=y.a.Content,P=F.a.info,I=F.a.error,R=F.a.success,V={labelCol:{span:10},wrapperCol:{span:14}},T={md:24,lg:12,xl:8},K=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(f.a)(this,Object(g.a)(t).call(this,e))).generateForm=function(e){var t=a.props.form,l=(t.getFieldDecorator,t.setFieldsValue),n=[],o=[];e.forEach(function(e){1===e.canSearch&&(n.push(e.tableCollumName),o.push(e))}),a.setState({fields:Object(m.a)(new Set(n))}),l({keys:o})},a.loadPage=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50;a.setState({pageNo:e},function(){a.props.form.validateFields(function(l,n){if(!l){var o=a.state.fields,r={};r.pageNo=e,r.pageSize=t,r.tableName=n.fileId,o.forEach(function(e){n[e]&&""!==n[e]&&(r[e]=n[e])}),a.props.actions.getTableList(r),a.setState({selectedRowKeys:[],selectedRows:[]})}})})},a.handlePageChange=function(e,t){a.loadPage(e,t)},a.handleShowSizeChange=function(e,t){a.loadPage(1,t)},a.handleSearch=function(e){e&&e.preventDefault(),a.loadPage()},a.batchUpdate=function(){var e=a.state.selectedRows,t=a.props.form.getFieldValue;a.props.actions.batchUpdate({list:e,tableName:t("fileId")})},a.showSuccess=function(e){R({title:"\u64cd\u4f5c\u6210\u529f",content:e,okText:"\u786e\u5b9a",okType:"info",onOk:function(){a.loadPage()}})},a.showError=function(e){I({title:"\u64cd\u4f5c\u5931\u8d25",content:e,okText:"\u786e\u5b9a",okType:"info"})},a.showInfo=function(e){P({title:"\u64cd\u4f5c\u63d0\u793a",content:e,okText:"\u786e\u5b9a",okType:"info"})},a.exportFile=function(){var e=(0,a.props.form.getFieldValue)("fileId");e&&""!==e?window.open("".concat(x.a.config.export,"?tableName=").concat(e)):a.showError("\u8bf7\u5148\u9009\u62e9\u8981\u5bfc\u51fa\u7684\u6587\u4ef6!")},a.changeSelectGroup=function(e){e&&""!==e&&(a.props.actions.getColumnList({tableName:e}),a.loadPage())},a.getFileList=function(){a.props.actions.getFileList()},a.handleShowModal=function(e){var t=e.modalVar,l=e.flag,n=e.cb;a.setState(Object(u.a)({},t,l)),n&&n()},a.handleFieldsBlur=function(e){var t=e.key,l=e.value;(0,a.props.form.setFieldsValue)(Object(u.a)({},t,l))},a.handleBlur=function(e){var t=e.key,l=e.value,n=e.formKey,o=e.id;(0,a.props.form.setFieldsValue)(Object(u.a)({},n,l)),a.props.actions.editData({key:t,value:l,id:o})},a.resetForm=function(){a.props.form.resetFields()},a.state={isShowModal:!1,fileLoading:!1,confirmLoading:!1,selectedRowKeys:[],selectedRows:[],formSearch:[],fields:[]},a}return Object(b.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.getFileList()}},{key:"componentWillReceiveProps",value:function(e){this.props.refreshFileFlag!==e.refreshFileFlag&&e.refreshFileFlag&&(this.getFileList(),this.props.actions.resetState()),this.props.columnList!==e.columnList&&e.columnList.length>0&&this.generateForm(e.columnList),this.props.operateSuccessFlag!==e.operateSuccessFlag&&!0===e.operateSuccessFlag&&(this.showSuccess(e.operateInfo),this.props.actions.resetState()),this.props.operateFailFlag!==e.operateFailFlag&&!0===e.operateFailFlag&&(this.showError(e.operateInfo),this.props.actions.resetState())}},{key:"render",value:function(){var e=this,t=this,a=this.props.form,u=a.getFieldDecorator,m=a.getFieldValue;console.log(m("keys"));var h=this.props,d=h.columnList,f=h.tableList,g=h.fileList,b=h.loading,F=h.role;console.log(F);var y=this.state,S=y.fileLoading,C=y.selectedRowKeys,k=this.props.pageInfo,x=k.pageNum,L=k.total,N=k.pageSize,P=d&&d.length>0?d.filter(function(e){return 1===e.canView}).map(function(t){return{title:t.excelCollumName,key:t.tableCollumName,render:function(a,l){return 1===t.canEdit?v.a.createElement(O,{label:""},u("".concat(t.tableCollumName,"_").concat(l.id),{initialValue:l[t.tableCollumName],onChange:function(a){return e.handleBlur({id:l.id,formKey:"".concat(t.tableCollumName,"_").concat(l.id),value:a.target.value,key:t.tableCollumName})}})(v.a.createElement(p.a,{placeholder:"\u8bf7\u8f93\u5165",style:{width:"100px"}}))):v.a.createElement("span",null,l[t.tableCollumName])}}}):[],I={current:x,total:L,pageSize:N,showSizeChanger:!0,showQuickJumper:!0,onChange:this.handlePageChange,onShowSizeChange:this.handleShowSizeChange},R={name:"file",beforeUpload:function(e,t){},showUploadList:!1,customRequest:function(e){var a=new FormData;a.append("excelFile",e.file),t.props.actions.uploadFile(a)}},K={selectedRowKeys:C,onChange:function(t,a){e.setState({selectedRowKeys:t,selectedRows:a})},getCheckboxProps:function(e){return{disabled:!1,name:e.name}}};u("keys",{initialValue:[]});var z=m("keys").map(function(t){return v.a.createElement(c.a,T,v.a.createElement(O,Object.assign({},V,{label:"".concat(t.excelCollumName)}),u("".concat(t.tableCollumName),{initialValue:"",onChange:function(a){return e.handleFieldsBlur({id:t.tableCollumName,value:a.target.value})}})(v.a.createElement(p.a,{placeholder:"\u8bf7\u8f93\u5165"}))))});return v.a.createElement("div",{className:"page-index"},v.a.createElement(l.a,{spinning:S},v.a.createElement(j,null,v.a.createElement(w.a,{className:"ant-advanced-search-form",onSubmit:this.handleSearch},v.a.createElement(o.a,{gutter:24},v.a.createElement("h3",null,"\u6587\u4ef6\u4e0a\u4f20"),v.a.createElement(c.a,{span:10,style:{height:70}},v.a.createElement(O,{labelCol:{span:6},wrapperCol:{span:18},label:"\u6587\u4ef6"},u("fileId",{rules:[{required:!0,whitespace:!0,message:"\u8bf7\u5148\u9009\u62e9\u6587\u4ef6"}]})(v.a.createElement(s.a,{showSearch:!0,optionFilterProp:"children",allowClear:!0,style:{width:400},placeholder:"\u8bf7\u9009\u62e9",onSelect:this.changeSelectGroup},g&&g.length>0&&g.map(function(e){return v.a.createElement(s.a.Option,{title:e.excelName,key:"tableFile_".concat(e.id),value:e.tableName},e.excelName)}))))),F&&"admin"===F&&v.a.createElement(E.Fragment,null,v.a.createElement(c.a,{span:8,style:{textAlign:"left"}},v.a.createElement(r.a,R,v.a.createElement(i.a,{type:"primary"},"\u4e0a\u4f20\u6587\u4ef6")),v.a.createElement(i.a,{style:{marginLeft:"10px"},type:"default",onClick:this.exportFile},"\u5bfc\u51fa")),v.a.createElement(c.a,{style:{clear:"both"}}))),v.a.createElement(o.a,{gutter:24},z),v.a.createElement(o.a,{gutter:24},v.a.createElement(c.a,Object.assign({},T,{style:{marginLeft:"100px",marginBottom:"15px"}}),v.a.createElement(i.a,{type:"primary",htmlType:"submit"},"\u67e5\u8be2"),"\xa0\xa0\xa0\xa0",v.a.createElement(i.a,{type:"default",onClick:this.resetForm},"\u91cd\u7f6e")))),v.a.createElement("h3",{style:{margin:"0 0 5px",paddingTop:"25px",borderTop:"1px solid #ddd"}},"\u6587\u4ef6\u8bb0\u5f55"),v.a.createElement(o.a,{gutter:24,style:{marginBottom:"10px"}},v.a.createElement(c.a,{style:{textAlign:"left"},span:12},v.a.createElement(i.a,{type:"primary",onClick:this.batchUpdate,disabled:!C.length>0},"\u6279\u91cf\u66f4\u65b0")),v.a.createElement(c.a,{style:{textAlign:"right"},span:12},v.a.createElement("div",{className:"search-count"},"\u5171 ",I.total," \u6761"))),v.a.createElement(l.a,{spinning:b},v.a.createElement(n.a,{scroll:{x:"max-content"},rowKey:"id",className:"table-list",rowSelection:K,dataSource:f,columns:P,pagination:I})))))}}]),t}(E.PureComponent),z=w.a.create()(K);t.default=Object(S.connect)(function(e){var t=e.resumeReducer;return{resultList:t.resultList,operateSuccessFlag:t.operateSuccessFlag,operateFailFlag:t.operateFailFlag,operateInfo:t.operateInfo,tableList:t.tableList,fileList:t.fileList,refreshFileFlag:t.refreshFileFlag,columnList:t.columnList,pageInfo:t.pageInfo,loading:t.loading}},function(e){return{actions:Object(C.bindActionCreators)(k.a,e)}})(function(e){var t=function(t){function a(e){var t;return Object(h.a)(this,a),(t=Object(f.a)(this,Object(g.a)(a).call(this,e))).state={role:"/employee"===e.route.path?"employee":"admin"},t}return Object(b.a)(a,t),Object(d.a)(a,[{key:"componentWillReceiveProps",value:function(e){this.props.route.path!==e.route.path&&""!==e.route.path&&("/employee"===e.route.path?this.setState({role:"employee"}):this.setState({role:"admin"}))}},{key:"render",value:function(){var t=this.state.role;return v.a.createElement(e,Object.assign({role:t},this.props))}}]),a}(E.PureComponent);return N()(t,e)}(z))}}]);
//# sourceMappingURL=4.890ce4f2.chunk.js.map